USE CLOUDWICK;

CREATE TABLE IF NOT EXISTS PARTDEPT(
	EMPID INT,
	EMPNAME STRING
)
PARTITIONED BY (DEPTNAME STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ',';

set hive.exec.dynamic.partition.mode=nonstrict;

INSERT OVERWRITE TABLE PARTDEPT PARTITION(DEPTNAME)
SELECT EMPID,EMPNAME,DEPTNAME FROM EMPDEPT
WHERE DEPTNAME IS NOT NULL;
